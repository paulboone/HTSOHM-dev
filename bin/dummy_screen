#!/bin/bash

LIBRARY_DIR=$1

IFS=$'\n' read -d '' -r -a D_LIST < $LIB_DIR/dummyList.txt

LIBRARY_SIZE=${#D_LIST[@]}

if ((LIBRARY_SIZE < 5))
    then
        NUM_PROC=1
fi

if ((LIBRARY_SIZE >= 5))
    then
        NUM_PROC=$((LIBRARY_SIZE / 5))
fi

echo $NUM_PROC

export HTSOHM_DIR=${HOME}/HTSOHM-dev
export LIB_DIR=${HOME}/HTSOHM-dev/$LIBRARY_DIR
export RASPA_DIR=${HOME}/RASPA

cd $HTSOHM_DIR/bin
echo 'submitting jobs ...'
source $HTSOHM_DIR/bin/qsub_dummy $LIB_DIR $NUM_PROC qdumCH4
source $HTSOHM_DIR/bin/qsub_dummy $LIB_DIR $NUM_PROC qdumSA
source $HTSOHM_DIR/bin/qsub_dummy $LIB_DIR $NUM_PROC qdumHV

echo ' ... done!'
